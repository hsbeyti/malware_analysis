

## **Steps to Modify VirtualBox 7.1.4 VM Identifiers**

### **1. Change the VM Name**
1. Open **VirtualBox Manager**.
2. Select your VM, right-click, and choose **Settings**.
3. Navigate to the **General** tab and update the **Name** field to something like `Office-PC` or `Workstation-01`.
4. Apply changes and restart the VM to reflect the new name.

---

### **2. Modify System Manufacturer and Model**
1. **Set Custom System Manufacturer and Model Strings:**
- Use the following `VBoxManage` commands:
```bash
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/pcbios/0/Config/DmiSystemVendor" "Dell Inc."
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/pcbios/0/Config/DmiSystemProduct" "Inspiron 15 7000"
```

2. **Check Changes:**
- Boot the VM and run `msinfo32` in the guest OS to confirm the changes.

---

### **3. Modify BIOS Information**
1. **Set BIOS Strings:**
- Use these `VBoxManage` commands:
```bash
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVendor" "American Megatrends Inc."
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVersion" "A16"
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseDate" "07/15/2021"
```

2. **Modify System Time Offset:**
- To make the BIOS date and time more realistic, run:
```bash
VBoxManage modifyvm "<VM Name>" --biossystemtimeoffset -500000000
```

---

### **4. Modify CPU Information**
1. **Spoof CPUID Data:**
- VirtualBox 7.1.4 allows custom CPUID settings:
```bash
VBoxManage modifyvm "<VM Name>" --cpuidset 00000001 000306a9 00100800 7fbae3ff bfebfbff
```

2. **Verify Changes:**
- Use tools like [CPU-Z](https://www.cpuid.com/softwares/cpu-z.html) within the VM to ensure the CPU data is updated.

---

### **5. Modify MAC Address**
1. **Change MAC Address:**
- Open **VirtualBox Manager**.
- Navigate to **Settings** > **Network** > **Advanced**.
- Set the **MAC Address** to something realistic, e.g., `00:1A:2B:3C:4D:5E`.

2. **Use a MAC Vendor Lookup Tool:**
- Use a tool like [Wireshark's OUI Lookup](https://www.wireshark.org/tools/oui-lookup.html) to generate a MAC address that matches a specific vendor, such as Intel or Realtek.

---

### **6. Modify Disk Serial Number**
1. **Set Custom Disk Identifier:**
- Shut down the VM and run the following command:
```bash
VBoxManage setextradata "<VM Name>" "VBoxInternal/Devices/ahci/0/Config/SerialNumber" "WD-WCC4E3UY1234"
```
- Replace `WD-WCC4E3UY1234` with a realistic serial number.

---

### **7. Modify Windows Product ID and Registered Owner**
1. **Change Product ID:**
- Open the registry editor (`regedit`) in the guest OS.
- Navigate to:
```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion
```
- Edit the `ProductId` key with a realistic value, such as `00330-80000-00000-AA123`.

2. **Update Registered Owner and Organization:**
- Modify the `RegisteredOwner` and `RegisteredOrganization` keys:
- `RegisteredOwner`: Change to a realistic name, e.g., `John Doe`.
- `RegisteredOrganization`: Set to a common organization name or leave blank.

---

### **8. Modify Network Configuration**
1. **Set a Static IP Address:**
- Open **Control Panel** > **Network and Sharing Center**.
- Configure the Ethernet adapter with a static IP, e.g., `192.168.1.101`.

2. **Spoof Adapter Details:**
- Rename the network adapter in **Device Manager** to something realistic, such as:
```
Intel(R) Ethernet Connection (2) I218-V
```

---

### **9. Modify Locale and Time Zone**
1. **Change Locale:**
- Open **Control Panel** > **Region**.
- Set the format to `English (United States)` or a suitable locale.

2. **Set Time Zone:**
- Go to **Settings** > **Time & Language** > **Date & Time**.
- Change the time zone to `(UTC-05:00) Eastern Time (US & Canada)` or another realistic setting.

---

### **10. Verify Changes**
After completing the steps, verify that:
1. `msinfo32` in the guest OS reflects realistic data.
2. Tools like [Pafish](https://github.com/a0rtega/pafish) confirm the VM no longer exhibits obvious virtualization artifacts.
3. Malware samples behave as expected in the sandbox environment.

By carefully modifying these details, you can ensure that your VirtualBox 7.1.4 VM appears more realistic, helping you to better analyze malware behavior.